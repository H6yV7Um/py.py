!function(){var t={name:"oojs",namespace:"","class":{},$oojs:function(t){if(t=t||{},"undefined"!=typeof window&&"undefined"!=typeof document?(this.runtime="browser",t.global=window):(this.runtime="node",t.global=global),t.proxyName="proxy",t.path="node"===this.runtime?process.cwd()+"/src/":"","undefined"!=typeof $oojs_config)for(var e in $oojs_config)e&&$oojs_config.hasOwnProperty(e)&&(t[e]=$oojs_config[e]);this.global=t.global||{},t.proxyName&&(Function.prototype[t.proxyName]=this.proxy),this.setPath(t.path),this.global.oojs=this.global.oojs||this},path:{},pathCache:{},getPath:function(t){var e=t?t.split("."):!1,n=this.path;if(e)for(var s=0,a=e.length;a>s;s++){var i=e[s].toLowerCase();if(!n[i])break;n=n[i]}return n._path},setPath:function(t,e){var n=this.path;if("object"!=typeof t){if(e)for(var s=t.split("."),a=0,i=s.length;i>a;a++){var r=s[a].toLowerCase();n[r]=n[r]||{_path:n._path},n=n[r]}else e=t;e&&e.lastIndexOf("\\")!==e.length-1&&e.lastIndexOf("/")!==e.length-1&&(e+="/"),n._path=e}else for(var o in t)o&&t.hasOwnProperty(o)&&this.setPath(o,t[o])},getClassPath:function(t){return this.pathCache[t]||(this.pathCache[t]=this.getPath(t)+t.replace(/\./gi,"/")+".js"),this.pathCache[t]},loadDeps:function(t,e){e=e||{};var n=t.deps,s=!0;for(var a in n)if(a&&n.hasOwnProperty(a)&&n[a]){var i;if("string"!=typeof n[a]?(t[a]=n[a],t[a]&&t[a].name&&(t[a].namespace=t[a].namespace||"",i=t[a].namespace+t[a].name)):(i=n[a],t[a]=this.find(i)),!i||e[i])continue;e[i]=!0,t[a]?t[a].deps&&(s=s&&this.loadDeps(t[a],e)):("node"===this.runtime&&(t[a]=require(this.getClassPath(i))),t[a]||(s=!1))}return s},fastClone:function(t){var e=function(){};e.prototype=t;var n=new e;return n},proxy:function(){var t=Array.prototype.slice.apply(arguments),e=t.shift(),n="function"==typeof this?this:t.shift();return function(){var s=Array.prototype.slice.apply(arguments);return n.apply(e,s.concat(t))}},config:function(){for(var t in obj)t&&obj.hasOwnProperty(t)&&("path"===t||"basePath"===t)&&this.setPath(obj[t])},create:function(t){var e=Array.prototype.slice.call(arguments,0);if(e.shift(),"string"==typeof t&&(t=this.using(t)),!t||!t.name)throw new Error("oojs.create need a class object with a name property");var n="__"+t.name||"init",s=function(){};s.prototype=t;var a=new s;for(var i in t){var r=t[i];r&&t.hasOwnProperty(i)&&"object"==typeof r&&(a[i]=this.fastClone(r))}return a[n]=a[n]||function(){},a[n].apply(a,e),a.instances=null,a},define:function(t){var e=t.name,n="$"+e;t.namespace=t.namespace||"",t.dispose=t.dispose||function(){},t["__"+e]=t[e]||function(){};for(var s,a=!1,i=!1,r=t.namespace.split("."),o=r.length,l=this.class,h=0;o>h;h++)s=r[h],s&&(l[s]=l[s]||{},l=l[s]);if(l[e]=l[e]||{},l[e].name&&l[e]._registed){if(l[e]._registed){a=!0;for(var c in t)c&&t.hasOwnProperty(c)&&"undefined"==typeof l[e][c]&&(i=!0,l[e][c]=t[c])}}else t._registed=!0,l[e]=t;if(t=l[e],!a||i){var u=this.loadDeps(t);u||"browser"!==this.runtime?t[n]&&t[n]():(this.loader=this.loader||this.using("oojs.loader"),this.loader&&this.loader.loadDepsBrowser(t))}return"node"===this.runtime&&arguments.callee.caller.arguments[2]&&(arguments.callee.caller.arguments[2].exports=t),this},find:function(t){var e,n=t.split(".");e=this.class[n[0]];for(var s=1,a=n.length;a>s;s++){if(!e||!e[n[s]]){e=null;break}e=e[n[s]]}return e},using:function(t){var e=this.find(t);return e||"node"===this.runtime&&(require(this.getClassPath(t)),e=this.find(t)),e},reload:function(t){var e=this.find(t);if(e){if(e._registed=!1,"node"===this.runtime){var n=this.getClassPath(t);delete require.cache[require.resolve(n)],e=require(n)}}else e=this.using(t);return e}};t.define(t)}(),oojs.define({name:"event",namespace:"oojs",eventList:null,groupList:null,eventGroupIndexer:null,$event:function(){},event:function(){this.eventList={},this.groupList={},this.eventGroupIndexer={}},bind:function(t,e){var n=this.eventList[t]=this.eventList[t]||{};return n.status?e(n.emitData):((n.callbacks=n.callbacks||[]).push(e),n.status=!1),this},removeListener:function(t,e){if(this.eventList[t]){var n=this.eventList[t];if(n.callbacks&&n.callbacks.length)for(var s=0,a=n.callbacks.length;a>s;s++)if(e){if(e===n.callbacks[s]){n.callbacks[s]=null;break}}else n.callbacks[s]=null}},unbind:function(t,e){if(t||e)this.removeListener(t,e);else{var n;for(n in this.eventList)n&&this.eventList[n]&&this.eventList.hasOwnProperty(n)&&this.removeListener(n)}},emit:function(t,e){var n=this.eventList[t];if(n){if(n.callbacks&&n.callbacks.length){var s=n.callbacks.length;n.data=[];for(var a=0;s>a;a++){var i=n.callbacks[a];i&&n.data.push(i(e))}n.callbacks=null}}else n=this.eventList[t]={};n.status=!0,n.emitData=e||{};for(var r,o=this.eventGroupIndexer[t]||[],a=0,l=o.length;l>a;a++)r=o[a],r&&this.groupEmit(r)},group:function(t,e,n){this.groupList[t]=this.groupList[t]||{};var s=this.groupList[t],a=s.events=s.events||{};n&&(s.callbacks=s.callbacks||[]).push(n);for(var i,e=e||[],r=0,o=e.length;o>r;r++)i=e[r],a[i]=1,(this.eventGroupIndexer[i]=this.eventGroupIndexer[i]||[]).push(t)},groupEmit:function(t){var e=this.groupList[t];if(e){var n,s,a=e.events=e.events||{},i=!0,r={};for(n in a)if(n&&a.hasOwnProperty(n)){if(s=this.eventList[n],!s||!s.status){i=!1,r=null;break}r[n]=s.data}if(n=null,i){e.callbacks=e.callbacks||[];for(var o,l=e.callbacks,h=l.length||0,c=0;h>c;c++)o=e.callbacks[c],o&&(o(r),e.callbacks[c]=null);o=null,e.callbacks=null;for(var u,f=e.afters=e.afters||[],h=f.length||0,c=0;h>c;c++)u=f[c],u&&(u(r),f[c]=null);u=null,e.afters=null}}},afterGroup:function(t,e){var n=this.groupList[t]=this.groupList[t]||{},s=n.afters=n.afters||[];s.push(e)}}),oojs.define({name:"loader",namespace:"oojs",deps:{event:"oojs.event"},$loader:function(){this.ev=oojs.create(this.event)},isNullObj:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},loadScript:function(t,e,n){if("function"==typeof e&&(n=e,e="1.0.0"),e=e||"1.0.0",e&&(t+="?v="+e),n=n||function(){},this.ev.bind(t,oojs.proxy(this,function(t,e){e&&e()},n)),this.loading=this.loading||{},!this.loading[t]){this.loading[t]=1;var s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src=t,s.onload=s.onerror=s.onreadystatechange=oojs.proxy(this,function(t,e,n){"string"==typeof t&&(e=t,n=e),/loaded|complete|undefined/.test(n.readyState)&&(n.onload=n.onerror=n.onreadystatechange=null,n=void 0,this.ev.emit(e,1))},t,s);var a=document.getElementsByTagName("script")[0];return a.parentNode.insertBefore(s,a),this}},loadDepsBrowser:function(t){var e=t.deps,n="$"+t.name;if(this.isNullObj(e))t[n]&&t[n]();else for(var s in e)if(s&&e.hasOwnProperty(s)){var a=e[s],i=oojs.using(a);if(i){t[s]=i;continue}this.ev.bind(a,oojs.proxy(this,function(t,e){return oojs.using(e)},a)),this.ev.group("loadDeps",[a],oojs.proxy(this,function(t,e,n,s){s[e]=t[n][0]},s,a,t)),this.ev.afterGroup("loadDeps",oojs.proxy(this,function(t,e){var n="$"+e.name;e[n]&&e[n]()},t));var r=oojs.getPath(t.namespace||""+t.name),o=oojs.proxy(this,function(t){this.ev.emit(t)},a);this.loadScript(r,o)}return oojs}});